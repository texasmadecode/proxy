name: Deploy to GitHub Pages

on:
  push:
    branches: [ main ]
  workflow_dispatch:

permissions:
  contents: read
  pages: write
  id-token: write

jobs:
  build-docs:
    name: Build Documentation
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout code
      uses: actions/checkout@v4
    
    - name: Create documentation site
      run: |
        mkdir -p docs
        
        # Convert README to HTML
        cat > docs/index.html << 'HTMLEOF'
        <!DOCTYPE html>
        <html lang="en">
        <head>
            <meta charset="UTF-8">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
            <title>Master Proxy Documentation</title>
            <style>
                * { margin: 0; padding: 0; box-sizing: border-box; }
                body {
                    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
                    line-height: 1.6;
                    color: #333;
                    background: #f5f5f5;
                }
                .container {
                    max-width: 1200px;
                    margin: 0 auto;
                    padding: 20px;
                }
                header {
                    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                    color: white;
                    padding: 60px 20px;
                    text-align: center;
                    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
                }
                header h1 { font-size: 48px; margin-bottom: 10px; }
                header p { font-size: 20px; opacity: 0.9; }
                .content {
                    background: white;
                    padding: 40px;
                    margin: 30px 0;
                    border-radius: 10px;
                    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
                }
                .badge {
                    display: inline-block;
                    padding: 5px 10px;
                    background: #667eea;
                    color: white;
                    border-radius: 5px;
                    font-size: 12px;
                    margin: 5px;
                }
                .mode-grid {
                    display: grid;
                    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
                    gap: 20px;
                    margin: 30px 0;
                }
                .mode-card {
                    background: #f8f9fa;
                    padding: 20px;
                    border-radius: 8px;
                    border-left: 4px solid #667eea;
                }
                .mode-card h3 { margin-bottom: 10px; color: #667eea; }
                code {
                    background: #f4f4f4;
                    padding: 2px 6px;
                    border-radius: 3px;
                    font-family: 'Courier New', monospace;
                }
                pre {
                    background: #2d2d2d;
                    color: #f8f8f8;
                    padding: 15px;
                    border-radius: 5px;
                    overflow-x: auto;
                }
                a { color: #667eea; text-decoration: none; }
                a:hover { text-decoration: underline; }
            </style>
        </head>
        <body>
            <header>
                <h1>üöÄ Master Proxy</h1>
                <p>Multi-Mode Web Bypass System</p>
                <div style="margin-top: 20px;">
                    <span class="badge">6 Proxy Modes</span>
                    <span class="badge">Video Streaming</span>
                    <span class="badge">Resource Inlining</span>
                    <span class="badge">Encrypted Tunnel</span>
                </div>
            </header>
            
            <div class="container">
                <div class="content">
                    <h2>üìñ Documentation</h2>
                    <p>Comprehensive proxy server combining 6 successful bypass strategies.</p>
                    
                    <h3 style="margin-top: 30px;">Quick Start</h3>
                    <pre>pip install flask requests flask-sock simple-websocket
python master_proxy.py</pre>
                    
                    <h3 style="margin-top: 30px;">Proxy Modes</h3>
                    <div class="mode-grid">
                        <div class="mode-card">
                            <h3>üé¨ FlixHQ Streaming</h3>
                            <p>Aggressive video/iframe interception for streaming sites</p>
                            <code>/flixhq/</code>
                        </div>
                        <div class="mode-card">
                            <h3>üìπ Video Proxy</h3>
                            <p>Server-side video streaming (MP4, HLS, DASH)</p>
                            <code>/video-proxy?url=...</code>
                        </div>
                        <div class="mode-card">
                            <h3>üñºÔ∏è Iframe Proxy</h3>
                            <p>Recursive iframe proxying with interception</p>
                            <code>/iframe-proxy?url=...</code>
                        </div>
                        <div class="mode-card">
                            <h3>‚ö° Ultra Mode</h3>
                            <p>Complete server-side page assembly</p>
                            <code>/ultra/?url=...</code>
                        </div>
                        <div class="mode-card">
                            <h3>üîí VPN Tunnel</h3>
                            <p>Encrypted WebSocket tunnel</p>
                            <code>/tunnel</code>
                        </div>
                        <div class="mode-card">
                            <h3>ü•∑ Stealth Mode</h3>
                            <p>Resources as JSON text/plain</p>
                            <code>/stealth/</code>
                        </div>
                    </div>
                    
                    <h3 style="margin-top: 30px;">Resources</h3>
                    <ul style="margin-left: 20px;">
                        <li><a href="https://github.com/texasmadecode/proxy">GitHub Repository</a></li>
                        <li><a href="https://github.com/texasmadecode/proxy/blob/main/MASTER_PROXY_README.md">Full Documentation</a></li>
                        <li><a href="https://github.com/texasmadecode/proxy/blob/main/QUICKSTART.txt">Quick Start Guide</a></li>
                        <li><a href="https://github.com/texasmadecode/proxy/blob/main/PROXY_ANALYSIS.md">Technical Analysis</a></li>
                    </ul>
                    
                    <h3 style="margin-top: 30px;">‚ö†Ô∏è Disclaimer</h3>
                    <p>Educational use only. Respect Terms of Service, copyright laws, and policies. No warranty provided.</p>
                </div>
            </div>
        </body>
        </html>
        HTMLEOF
    
    - name: Upload artifact
      uses: actions/upload-pages-artifact@v2
      with:
        path: docs
    
  deploy:
    name: Deploy to Pages
    needs: build-docs
    runs-on: ubuntu-latest
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    
    steps:
    - name: Deploy to GitHub Pages
      id: deployment
      uses: actions/deploy-pages@v2
